<!doctype html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	 <title>Book Library</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="apple-touch-icon" href="apple-touch-icon.png">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/normalize.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/icomoon.css">
	<link rel="stylesheet" href="css/jquery-ui.css">
	<link rel="stylesheet" href="css/owl.carousel.css">
	<link rel="stylesheet" href="css/transitions.css">
	<link rel="stylesheet" href="css/main.css">
	<link rel="stylesheet" href="css/color.css">
	<link rel="stylesheet" href="css/responsive.css">
	<script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
</head>
<body>

	<div id="tg-wrapper" class="tg-wrapper tg-haslayout">
		<header id="tg-header" class="tg-header tg-haslayout">
			<div class="tg-topbar">
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<div class="tg-userlogin">
								<div>
								<li style="list-style:none ;" class="menu-item-has-children"
									sec:authorize = "isAuthenticated()">
									<a href=""> <i id="user_icon" class="fa fa-user"></i> Xin chào <span class="sr-only"></span></a>
									<div class="mega-menu user">
										<ul class="tg-themetabnav " role="tablist">
											<li><a th:href="@{/profile}">Trang cá nhân<span class="sr-only">(current)</span></a></li>
											<li><a th:href="@{/orders}" sec:authorize = "hasRole('USER')">Thông tin mua hàng<span class="sr-only">(current)</span></a></li>
											<li><a class="tg-userlogout" th:href="@{/logout}">Đăng xuất<span class="sr-only">(current)</span></a></li>
										</ul>
								</li>
								<br>
								<a class="nav-link text" th:href="@{/signup}"
								   style="margin-right: 30px" sec:authorize = "!isAuthenticated()">
									Đăng kí<span class="sr-only">(current)</span></a>
								<a class="nav-link text" th:href="@{/login}"
								   sec:authorize = "!isAuthenticated()">
									Đăng nhập<span class="sr-only">(current)</span></a>
							</div>
							</div>
							<div>
								
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="tg-middlecontainer" style="padding: 10pxpx;">
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<strong class="tg-logo"><a href="index-2.html"><img src="images/logo.png" alt="company name here"></a></strong>
							<div class="tg-wishlistandcart">
								<div sec:authorize = "hasRole('USER')" class="dropdown tg-themedropdown tg-minicartdropdown">
									<a  id="tg-minicart" class="tg-btnthemedropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<span class="tg-themebadge" th:text="${cartInfo.getTotalBooks()}"></span>
										<a th:href="@{view-cart}"><i class="icon-cart"></i>
                  						<span style="margin-left: 10px;">Giỏ hàng</span></a>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="tg-navigationarea">
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<nav id="tg-nav" class="tg-nav">
								<div class="navbar-header">
									<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#tg-navigation" aria-expanded="false">
										<span class="sr-only">Toggle navigation</span>
										<span class="icon-bar"></span>
										<span class="icon-bar"></span>
										<span class="icon-bar"></span>
									</button>
								</div>
								<div id="tg-navigation" class="collapse navbar-collapse tg-navigation">
									<ul>
										<li><a th:href="@{/}">Trang chủ</a></li>
										<li><a th:href="@{/products}" sec:authorize = "!hasRole('ADMIN')">Sách</a></li>
										<li><a th:href="@{/manage-product}" sec:authorize = "hasRole('ADMIN')">Sách</a></li>
										<li><a th:href="@{/manage-category}" sec:authorize = "hasRole('ADMIN')">Danh mục</a></li>
										<li><a th:href="@{/manage-author}" sec:authorize = "hasRole('ADMIN')">Tác giả</a></li>
										<li><a th:href="@{/manage-user}" sec:authorize = "hasRole('ADMIN')">Khách hàng</a></li>
										<li><a th:href="@{/manage-order}" sec:authorize = "hasRole('ADMIN')">Đơn hàng</a></li>
										
									</ul>
								</div>
							</nav>
						</div>
					</div>
				</div>
			</div>
		</header>
		<div class="tg-innerbanner tg-haslayout tg-parallax tg-bginnerbanner" data-z-index="-100" data-appear-top-offset="600" data-parallax="scroll" data-image-src="images/parallax/bgparallax-07.jpg">
			<div class="container">
				<div class="row">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<div class="tg-innerbannercontent">
							<h1>Chi tiết về sách</h1>
							<ol class="tg-breadcrumb">
								<li><a href="javascript:void(0);">Trang Chủ</a></li>
								<li><a href="javascript:void(0);">Sách</a></li>
							</ol>
						</div>
					</div>
				</div>
			</div>
		</div>
		<main id="tg-main" class="tg-main tg-haslayout">
			<div class="tg-sectionspace tg-haslayout">
				<div class="container">
					<div class="row">
						<div id="tg-twocolumns" class="tg-twocolumns">
							<div class="col-xs-12 col-sm-8 col-md-8 col-lg-9 pull-right">
								<div id="tg-content" class="tg-content">
									<div class="tg-productdetail">
										<div class="row">
											<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
												<div class="tg-postbook">
													<figure class="tg-featureimg"><img th:src ="@{|/bookImage?id=${book.id}|}" alt="image description"></figure>
													<div class="tg-postbookcontent">
														<span class="tg-bookprice">
															<ins><span th:text="${book.price}"></span> VNĐ</ins>
														</span>
														<ul class="tg-delevrystock">
															<li><i class="icon-rocket"></i><span>Vận chuyển toàn quốc</span></li>
															<li><i class="icon-checkmark-circle"></i><span>Tại Hà Nội chỉ trong 2 ngày</span></li>
														</ul>
														<form th:action="@{/add-to-cart}" method="post" onsubmit="return validateQuantity()">
															<input type="hidden" th:value="${book.id}" name="id"/>
															<input type="hidden" id="numberInStock" th:value="${book.number_in_stock}">
															<div class="tg-quantityholder">
																<em class="minus">-</em>
																<input type="text" class="result" value="1" id="quantity1" name="quantity">
																<em class="plus">+</em>
															</div>
																<div sec:authorize = "isAuthenticated()">
																<button sec:authorize = "!hasRole('ADMIN')" class="tg-btn tg-active tg-btn-lg" type="submit">Thêm vào giỏ</button>
																</div>
																<div sec:authorize = "!isAuthenticated()">
																	<a th:href="@{/login}"><div  class="tg-btn tg-active tg-btn-lg" >Thêm vào giỏ</div></a>
																</div>
															</form>
													</div>
												</div>
											</div>
											<div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
												<div class="tg-productcontent">
													<ul class="tg-bookscategories">
														<li th:text="${book.category.name}"></li>
													</ul>
													<div class="tg-booktitle">
														<h3 th:text="${book.title}"></h3>
													</div>
													<span class="tg-bookwriter">Tác giả: <span th:text="${book.author.name}"></span></span>
													<span class="tg-bookwriter">Số trang: <span th:text="${book.number_page}"></span></span>
													<span class="tg-bookwriter">Ngày xuất bản:  <span th:text="${book.date_publication}"></span></span>
													<span class="tg-bookwriter">Đã bán: <span th:text="${book.number_sold}"></span></span>
													<span class="tg-bookwriter">Còn lại: <span th:text="${book.number_in_stock}"></span></span>
													<div class="tg-description">
														<p th:text="${book.description}"></p>
													</div>
												</div>
											</div>
											<div class="tg-aboutauthor">
												<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
													<div class="tg-sectionhead">
														<h2>Đánh giá</h2>
													</div>
													
													<div class="tg-authorbox" th:each="comment: ${book.commentList}">
														<div class="tg-authorinfo">
															<div class="tg-review">
																<div class="tg-leftarea">
																	<div class="tg-authorname">
																		<h2  th:text="${comment.user.name}"></h2>
																		<span th:text="${'Thời gian: '+comment.created_at}"></span>
																	</div>
																	<div>
																		<ul class="">
																			<li th:if="${1<=comment.star}" class="star_done checked"></li>
																			<li th:if="${1>comment.star}" class="star_done"></li>
																			<li th:if="${2<=comment.star}" class="star_done checked"></li>
																			<li th:if="${2>comment.star}" class="star_done"></li>
																			<li th:if="${3<=comment.star}" class="star_done checked"></li>
																			<li th:if="${3>comment.star}" class="star_done"></li>
																			<li th:if="${4<=comment.star}" class="star_done checked"></li>
																			<li th:if="${4>comment.star}" class="star_done"></li>
																			<li th:if="${5<=comment.star}" class="star_done checked"></li>
																			<li th:if="${5>comment.star}" class="star_done"></li>
																		</ul>
																	</div>
																</div>
															</div>
															<div class="tg-comment">
																<p th:text="${comment.content}"></p>
															</div>
														</div>
													</div>
													<form th:action="@{/save-comment}" th:object="${comment}" method="post">
														<div sec:authorize = "isAuthenticated()">
														<div sec:authorize = "!hasRole('ADMIN')" class="tg-authorbox">
															<div class="tg-authorinfo">
																<input type="hidden" name="book_id" th:value="${book.id}">
																<input type="hidden" name="username" th:value="${username}">
																<div class="tg-review">
																	<div class="tg-leftarea">
																		<div class="tg-authorname">
																			<h2>Đánh giá của bạn</h2>
																		</div>
																		<div>
																			<ul class="ratings">
																				<li class="star"></li>
																				<li class="star"></li>
																				<li class="star"></li>
																				<li class="star"></li>
																				<li class="star"></li>
																			  </ul>
																		</div>
																	</div>
																</div>
																<input type="number" th:field="*{star}" id="starts_submit" value="" style="display: none">
																<div class="tg-comment">
																	<textarea th:field="*{content}" id="" cols="50" rows="4" style=" resize: none; width: 100%; height: 100px;"></textarea>
																</div>
																<input class="tg-btn tg-active" type="submit" value="Đánh giá" style="margin-top: 10px;">
															</div>
														</div>
														</div>
													</form>
												</div>
											</div>
											
										</div>
									</div>
								</div>
							</div>
							<div class="col-xs-12 col-sm-4 col-md-4 col-lg-3 pull-left">
								<aside id="tg-sidebar" class="tg-sidebar">
									<div class="tg-widget tg-widgetsearch">
										<form class="tg-formtheme tg-formsearch" th:action="@{/search}">
											<div class="form-group">
												<button type="submit"><i class="icon-magnifier"></i></button>
												<input type="search" th:value="${keyword}" name="keyword" class="form-group" style = "width: 270px; "
													placeholder="Tìm kiếm với ... ">
												
											</div>
											<select name="type" class="form-group" style = "width: 130px; margin-top: 3px;" id="searchBy">
												<option value="title">Tiêu đề</option>
												<option value="author">Tác giả</option>
											</select>
										</form>
									</div>
									<div class="tg-widget tg-catagories">
										<div class="tg-widgettitle">
											<h3>Thể loại</h3>
										</div>
										<div class="tg-widgetcontent">
											<ul th:each="category: ${categoryList}">
												<li><a th:href="@{|/search?keyword=${category.name}&type=category|}"><span th:text="${category.name}" ></span>
													<em th:text="${category.bookList.size()}"></em></a></li>
											</ul>
										</div>
									</div>
								</aside>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>
		<footer id="tg-footer" class="tg-footer tg-haslayout">
			<div class="tg-footerarea">
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<ul class="tg-clientservices">
								<li class="tg-devlivery">
									<span class="tg-clientserviceicon"><i class="icon-rocket"></i></span>
									<div class="tg-titlesubtitle">
										<h3>Vận chuyển </h3>
										<p>Toàn quốc nhanh chóng</p>
									</div>
								</li>
								<li class="tg-discount">
									<span class="tg-clientserviceicon"><i class="icon-tag"></i></span>
									<div class="tg-titlesubtitle">
										<h3>Giá thành</h3>
										<p>Hợp lí hấp dẫn</p>
									</div>
								</li>
								<li class="tg-quality">
									<span class="tg-clientserviceicon"><i class="icon-leaf"></i></span>
									<div class="tg-titlesubtitle">
										<h3>Chất lượng</h3>
										<p>Chất lượng hàng đầu</p>
									</div>
								</li>
								<li class="tg-support">
									<span class="tg-clientserviceicon"><i class="icon-heart"></i></span>
									<div class="tg-titlesubtitle">
										<h3>Hỗ trợ 24/7</h3>
										<p>Phục vụ mọi lúc</p>
									</div>
								</li>
							</ul>
						</div>
						<div class="tg-threecolumns">
							<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
								<div class="tg-footercol">
									<strong class="tg-logo"><a href="javascript:void(0);"><img src="images/flogo.png" alt="image description"></a></strong>
									<ul class="tg-contactinfo">
										<li>
											<i class="icon-apartment"></i>
											<address>Hà Đông, Hà Nội, Việt Nam</address>
										</li>
										<li>
											<i class="icon-phone-handset"></i>
											<span>
												<em>0812 567 889</em>
												<em>+84 1245 6767</em>
											</span>
										</li>
										<li>
											<i class="icon-clock"></i>
											<span>
												Phục vụ 7 ngày trong tuần từ 9:00 - 22:00
											</span>
										</li>
										<li>
											<i class="icon-envelope"></i>
											<span>
												<em><a href="mailto:support@domain.com">support@booklibrary.com</a></em>
												<em><a href="mailto:info@domain.com">info@booklibrary.com</a></em>
											</span>
										</li>
									</ul>
									<ul class="tg-socialicons">
										<li class="tg-facebook"><a href="javascript:void(0);"><i class="fa fa-facebook"></i></a></li>
										<li class="tg-twitter"><a href="javascript:void(0);"><i class="fa fa-twitter"></i></a></li>
										<li class="tg-linkedin"><a href="javascript:void(0);"><i class="fa fa-linkedin"></i></a></li>
										<li class="tg-googleplus"><a href="javascript:void(0);"><i class="fa fa-google-plus"></i></a></li>
										<li class="tg-rss"><a href="javascript:void(0);"><i class="fa fa-rss"></i></a></li>
									</ul>
								</div>
							</div>
							<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
								<div class="tg-footercol tg-widget tg-widgetnavigation">
									<div class="tg-widgettitle">
										<h3>Chúng tôi xin đảm bảo</h3>
									</div>
					
									<div class="tg-widgetcontent">
										
										<ul>
											<li><a href="javascript:void(0);">Luôn tôn trọng khách hàng</a></li>
											<li><a href="javascript:void(0);">Bảo mật thông tin cần thiết</a></li>
											<li><a href="javascript:void(0);">Sách chính hãng</a></li>
											<li><a href="javascript:void(0);">Tuân theo quy định mua bán</a></li>
										</ul> 
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="tg-footerbar">
				<a id="tg-btnbacktotop" class="tg-btnbacktotop" href="javascript:void(0);"><i class="icon-chevron-up"></i></a>
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
							<span class="tg-paymenttype"><img src="images/paymenticon.png" alt="image description"></span>
							<span class="tg-copyright">2023 All Rights Reserved By &copy; Book Library</span>
						</div>
					</div>
				</div>
			</div>
		</footer>
	</div>
	<script src="js/vendor/jquery-library.js"></script>
	<script src="js/vendor/bootstrap.min.js"></script>
	<script src="https://maps.google.com/maps/api/js?key=AIzaSyCR-KEWAVCn52mSdeVeTqZjtqbmVJyfSus&amp;language=en"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/jquery.vide.min.js"></script>
	<script src="js/countdown.js"></script>
	<script src="js/jquery-ui.js"></script>
	<script src="js/parallax.js"></script>
	<script src="js/countTo.js"></script>
	<script src="js/appear.js"></script>
	<script src="js/gmap3.js"></script>
	<script src="js/main.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script>
		function validateQuantity() {
			var quantityInput = document.getElementById("quantity1");
			var quantity = parseInt(quantityInput.value);
			var numberInStock = parseInt(document.getElementById("numberInStock").value);
	
			if (quantity > numberInStock) {
				// alert("Số lượng thêm vào giỏ hàng vượt quá số lượng còn trong kho.");
				Swal.fire({
				position: 'top',
				icon: 'error',
				title: 'Số lượng thêm vượt quá <br> số lượng còn trong kho',
				showConfirmButton: false,
				timer: 1500,
				})
				quantityInput.focus();
				return false; // Ngăn chặn submit form
			}
			
			return true; // Cho phép submit form
		}
	</script>
</body>

</html>